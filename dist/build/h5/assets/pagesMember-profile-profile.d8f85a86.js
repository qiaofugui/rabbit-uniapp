import{d as a,g as e,l,m as s,s as t,o as r,c as u,w as n,a as c,b as o,e as d,n as i,u as v,t as f,Q as m,R as p,z as _,P as h,k as b,h as k,i as y,f as g,O as x,T as C,U as w,V as T,W as j,B as P}from"./index-92dffa4f.js";import{h as V}from"./http.819f3c8a.js";import{f as U}from"./index.67d40982.js";import{_ as B}from"./_plugin-vue_export-helper.1b428a4d.js";const F=B(a({__name:"profile",setup(a){const{safeAreaInsets:B}=e(),F=l({}),I=async()=>{const a=await V({method:"GET",url:"/member/profile"});F.value=a.result,O.profile.avatar=a.result.avatar,O.profile.nickname=a.result.nickname};s((()=>{I()}));const O=t(),q=()=>{m({count:1,success:a=>{const e=a.tempFilePaths;z(e[0])}})},z=a=>{p({url:"/member/profile/avatar",name:"file",filePath:a,success:a=>{if(200===a.statusCode){const e=JSON.parse(a.data).result.avatar;F.value.avatar=e,O.profile.avatar=e,_({icon:"success",title:"更新成功"})}else _({icon:"error",title:"出现错误"})}})},A=a=>{F.value.gender=a.detail.value},D=a=>{F.value.birthday=a.detail.value};let E=["","",""];const G=async()=>{const{nickname:a,gender:e,birthday:l}=F.value,s=await(t={nickname:a,gender:e,birthday:l,provinceCode:E[0],cityCode:E[1],countyCode:E[2]},V({method:"PUT",url:"/member/profile",data:t}));var t;O.profile.nickname=s.result.nickname,_({icon:"success",title:"保存成功"}),setTimeout((()=>{h()}),400)};return(a,e)=>{const l=b,s=k,t=y,m=g,p=x,_=C,h=w,V=T,I=j,O=P;return r(),u(s,{class:"viewport"},{default:n((()=>{var a;return[c(" 导航栏 "),o(s,{class:"navbar",style:i({paddingTop:(null==(a=v(B))?void 0:a.top)+"px"})},{default:n((()=>[o(l,{"open-type":"navigateBack",class:"back icon-left","hover-class":"none"}),o(s,{class:"title"},{default:n((()=>[d("个人信息")])),_:1})])),_:1},8,["style"]),c(" 头像 "),o(s,{class:"avatar"},{default:n((()=>[o(s,{onClick:q,class:"avatar-content"},{default:n((()=>{var a;return[o(t,{class:"image",src:null==(a=F.value)?void 0:a.avatar,mode:"aspectFill"},null,8,["src"]),o(m,{class:"text"},{default:n((()=>[d("点击修改头像")])),_:1})]})),_:1})])),_:1}),c(" 表单 "),o(s,{class:"form"},{default:n((()=>[c(" 表单内容 "),o(s,{class:"form-content"},{default:n((()=>[o(s,{class:"form-item"},{default:n((()=>[o(m,{class:"label"},{default:n((()=>[d("账号")])),_:1}),o(m,{class:"account placeholder"},{default:n((()=>{var a;return[d(f(null==(a=F.value)?void 0:a.account),1)]})),_:1})])),_:1}),o(s,{class:"form-item"},{default:n((()=>[o(m,{class:"label"},{default:n((()=>[d("昵称")])),_:1}),o(p,{class:"input",type:"text",placeholder:"请填写昵称",modelValue:F.value.nickname,"onUpdate:modelValue":e[0]||(e[0]=a=>F.value.nickname=a)},null,8,["modelValue"])])),_:1}),o(s,{class:"form-item"},{default:n((()=>[o(m,{class:"label"},{default:n((()=>[d("性别")])),_:1}),o(V,{onChange:A},{default:n((()=>[o(h,{class:"radio"},{default:n((()=>{var a;return[o(_,{value:"男",color:"#27ba9b",checked:"男"===(null==(a=F.value)?void 0:a.gender)},null,8,["checked"]),d(" 男 ")]})),_:1}),o(h,{class:"radio"},{default:n((()=>{var a;return[o(_,{value:"女",color:"#27ba9b",checked:"女"===(null==(a=F.value)?void 0:a.gender)},null,8,["checked"]),d(" 女 ")]})),_:1})])),_:1})])),_:1}),o(s,{class:"form-item"},{default:n((()=>{var a;return[o(m,{class:"label"},{default:n((()=>[d("生日")])),_:1}),o(I,{onChange:D,mode:"date",class:"picker",value:null==(a=F.value)?void 0:a.birthday,start:"1900-01-01",end:v(U)(new Date)},{default:n((()=>{var a;return[(null==(a=F.value)?void 0:a.birthday)?(r(),u(s,{key:0},{default:n((()=>{var a;return[d(f(null==(a=F.value)?void 0:a.birthday),1)]})),_:1})):(r(),u(s,{key:1,class:"placeholder"},{default:n((()=>[d("请选择日期")])),_:1}))]})),_:1},8,["value","end"])]})),_:1}),c(" 只有微信小程序端内置了省市区数据 "),o(s,{class:"form-item"},{default:n((()=>{var a;return[o(m,{class:"label"},{default:n((()=>[d("职业")])),_:1}),o(p,{class:"input",type:"text",placeholder:"请填写职业",value:null==(a=F.value)?void 0:a.profession},null,8,["value"])]})),_:1})])),_:1}),c(" 提交按钮 "),o(O,{onClick:G,class:"form-button"},{default:n((()=>[d("保 存")])),_:1})])),_:1})]})),_:1})}}}),[["__scopeId","data-v-adba0033"]]);export{F as default};

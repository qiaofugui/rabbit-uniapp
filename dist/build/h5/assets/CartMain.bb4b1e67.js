import{d as e,s as a,l as s,x as l,y as t,o as c,c as o,w as u,a as n,u as d,j as r,b as i,e as f,F as _,r as p,v as m,t as g,z as k,A as v,f as x,h as b,i as h,k as w,p as y,q as C,B as j,S as I,C as S}from"./index-92dffa4f.js";import{g as V,p as F,d as q,a as P,_ as R}from"./cart.01467339.js";import{_ as T,a as U}from"./uni-swipe-action.8ed3811d.js";import{u as z,_ as A}from"./index.98414691.js";import{d as B}from"./index.67d40982.js";import{_ as E}from"./_plugin-vue_export-helper.1b428a4d.js";const G=E(e({__name:"CartMain",setup(e){const{guessRef:E,onScrolltolower:G}=z(),M=a(),O=s([]),X=async()=>{const e=await V();O.value=e.result};l((()=>{M.profile&&X()}));const $=B((async e=>{await P(e.index,{count:e.value})}),500),D=t((()=>O.value.length&&O.value.every((e=>e.selected)))),H=()=>{const e=!D.value;O.value.forEach((a=>{a.selected=e})),F({selected:e})},J=t((()=>O.value.filter((e=>e.selected)))),K=t((()=>J.value.reduce(((e,a)=>e+a.count),0))),L=t((()=>J.value.reduce(((e,a)=>e+a.count*a.nowPrice),0).toFixed(2))),N=()=>{if(0===K.value)return k({icon:"none",title:"请选择商品"});v({url:"/pagesOrder/create/create"})};return(e,a)=>{const s=x,l=b,t=h,k=w,v=y(C("vk-data-input-number-box"),R),V=j,F=y(C("uni-swipe-action-item"),T),z=y(C("uni-swipe-action"),U),B=y(C("XtxGuess"),A),J=I;return c(),o(J,{"scroll-y":"",class:"scroll-view",onScrolltolower:d(G)},{default:u((()=>[n(" 已登录: 显示购物车 "),d(M).profile?(c(),r(_,{key:0},[n(" 购物车列表 "),O.value.length?(c(),o(l,{key:0,class:"cart-list"},{default:u((()=>[n(" 优惠提示 "),i(l,{class:"tips"},{default:u((()=>[i(s,{class:"label"},{default:u((()=>[f("满减")])),_:1}),i(s,{class:"desc"},{default:u((()=>[f("满1件, 即可享受9折优惠")])),_:1})])),_:1}),n(" 滑动操作分区 "),i(z,null,{default:u((()=>[n(" 滑动操作项 "),(c(!0),r(_,null,p(O.value,(e=>(c(),o(F,{key:e.skuId,class:"cart-swipe"},{right:u((()=>[i(l,{class:"cart-swipe-right"},{default:u((()=>[i(V,{class:"button delete-button",onClick:a=>{return s=e.skuId,void S({content:"确认删除吗",success:async e=>{e.confirm&&(await q({ids:[s]}),X())}});var s}},{default:u((()=>[f("删除")])),_:2},1032,["onClick"])])),_:2},1024)])),default:u((()=>[i(l,{class:"goods"},{default:u((()=>[n(" 选中状态 "),i(s,{class:m(["checkbox",{checked:e.selected}]),onClick:a=>(e=>{e.selected=!e.selected,P(e.skuId,{selected:e.selected})})(e)},null,8,["class","onClick"]),i(k,{url:`/pages/goods/goods?id=${e.id}`,"hover-class":"none",class:"navigator"},{default:u((()=>[i(t,{mode:"aspectFill",class:"picture",src:e.picture},null,8,["src"]),i(l,{class:"meta"},{default:u((()=>[i(l,{class:"name ellipsis"},{default:u((()=>[f(g(e.name),1)])),_:2},1024),i(l,{class:"attrsText ellipsis"},{default:u((()=>[f(g(e.attrsText),1)])),_:2},1024),i(l,{class:"price"},{default:u((()=>[f(g(e.nowPrice),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["url"]),n(" 商品数量 "),i(l,{class:"count"},{default:u((()=>[i(v,{modelValue:e.count,"onUpdate:modelValue":a=>e.count=a,min:1,max:e.stock,onChange:d($),index:e.skuId},null,8,["modelValue","onUpdate:modelValue","max","onChange","index"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})):(c(),r(_,{key:1},[n(" 购物车空状态 "),i(l,{class:"cart-blank"},{default:u((()=>[i(t,{src:"/static/images/blank_cart.png",class:"image"}),i(s,{class:"text"},{default:u((()=>[f("购物车还是空的，快来挑选好货吧")])),_:1}),i(k,{url:"/pages/index/index","hover-class":"none"},{default:u((()=>[i(V,{class:"button"},{default:u((()=>[f("去首页看看")])),_:1})])),_:1})])),_:1})],2112)),n(" 吸底工具栏 "),i(l,{class:"toolbar"},{default:u((()=>[i(s,{class:m(["all",{checked:d(D)}]),onClick:H},{default:u((()=>[f("全选")])),_:1},8,["class"]),i(s,{class:"text"},{default:u((()=>[f("合计:")])),_:1}),i(s,{class:"amount"},{default:u((()=>[f(g(d(L)),1)])),_:1}),i(l,{class:"button-grounp"},{default:u((()=>[i(l,{class:m(["button payment-button",{disabled:0===d(K)}]),onClick:N},{default:u((()=>[f(" 去结算("+g(d(K))+") ",1)])),_:1},8,["class"])])),_:1})])),_:1})],64)):(c(),r(_,{key:1},[n(" 未登录: 提示登录 "),i(l,{class:"login-blank"},{default:u((()=>[i(s,{class:"text"},{default:u((()=>[f("登录后可查看购物车中的商品")])),_:1}),i(k,{url:"/pages/login/login","hover-class":"none"},{default:u((()=>[i(V,{class:"button"},{default:u((()=>[f("去登录")])),_:1})])),_:1})])),_:1})],2112)),n(" 猜你喜欢 "),i(B,{ref_key:"guessRef",ref:E},null,512),n(" 底部占位空盒子 "),i(l,{class:"toolbar-height"})])),_:1},8,["onScrolltolower"])}}}),[["__scopeId","data-v-0a4feb27"]]);export{G as C};
